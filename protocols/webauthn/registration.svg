<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="827" height="1022" version="1.1"><desc>title%20Webauthn%20Registration%0A%0Aactor%20User%0Aparticipant%20Authenticator%0A%0ABrowser-%3EServer%3A%20I%20want%20to%20register!%0ABrowser%3C%3C--Server%3A%20challenge%0Anote%20over%20Browser%3A%20credentials.create(...)%0Aactivate%20Browser%0ABrowser-%3EAuthenticator%3A%20Create%20key%20pair%0AAuthenticator-%3EUser%3A%20Request%20biometrics%20or%20device%20PIN%0AAuthenticator%3C%3C--User%3A%20Done%0AAuthenticator-%3EAuthenticator%3A%20User%20verified%0AAuthenticator-%3EAuthenticator%3A%20Cryptographic%20key%20pair%20stored%0AAuthenticator--%3E%3EBrowser%3A%20Public%20key%2C%20%5Cnchallenge%20and%20%5Cnattestation%0Adeactivate%20Browser%0ABrowser-%3EServer%3A%20Public%20key%2C%20%5Cnchallenge%20and%20%5Cnattestation%0AServer-%3EServer%3A%20Verify%20challenge%0AServer-%3EServer%3A%20Check%20attestation%0AServer-%3EServer%3A%20Store%20public%20key%0ABrowser%3C%3C--Server%3A%20Device%20regsitered!</desc><g><g><rect width="827" height="1022" x="0" y="0" fill="#fff" stroke="none"/></g><g><text x="302.022" y="24.503" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="22" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Webauthn Registration</text></g><g><path fill="none" stroke="#000" stroke-dasharray="12.566 5.445" stroke-miterlimit="10" stroke-width="1.361" d="M 23.64361483359375 128.80307802049998 L 23.64361483359375 1022.3386985304999" paint-order="fill stroke markers"/><path fill="none" stroke="#000" stroke-dasharray="12.566 5.445" stroke-miterlimit="10" stroke-width="1.361" d="M 284.74880418372396 128.80307802049998 L 284.74880418372396 1022.3386985304999" paint-order="fill stroke markers"/><path fill="none" stroke="#000" stroke-dasharray="12.566 5.445" stroke-miterlimit="10" stroke-width="1.361" d="M 514.3459222271484 128.80307802049998 L 514.3459222271484 1022.3386985304999" paint-order="fill stroke markers"/><path fill="none" stroke="#000" stroke-dasharray="12.566 5.445" stroke-miterlimit="10" stroke-width="1.361" d="M 684.2200315866536 128.80307802049998 L 684.2200315866536 1022.3386985304999" paint-order="fill stroke markers"/></g><g><g><path fill="#fff" stroke="#000" stroke-miterlimit="10" stroke-width="2.777" d="M 32.95468071459375 59.70516806150002 A 9.311065881 9.311065881 0 1 1 32.9546760590612 59.69585699717086 M 23.64361483359375 69.01623394250002 L 23.64361483359375 88.94518196850002 M 11.882268457593753 76.20372339450002 L 35.40496120959375 76.20372339450002 M 23.64361483359375 88.94518196850002 L 11.882268457593753 107.56731373050002 M 23.64361483359375 88.94518196850002 L 35.40496120959375 107.56731373050002" paint-order="fill stroke markers"/></g><g><text x="8.168" y="123.903" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="#fff" stroke="#000" stroke-miterlimit="10" stroke-width="2.614" d="M 223.83257320283332 84.69802911050002 L 345.66503516461455 84.69802911050002 L 345.66503516461455 128.8030780205 L 223.83257320283332 128.8030780205 L 223.83257320283332 84.69802911050002 Z" paint-order="fill stroke markers"/></g><g><text x="241.556" y="112.468" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Authenticator</text></g><path fill="none" stroke="none"/><g><path fill="#fff" stroke="#000" stroke-miterlimit="10" stroke-width="2.614" d="M 469.7396353990898 84.69802911050002 L 558.952209055207 84.69802911050002 L 558.952209055207 128.8030780205 L 469.7396353990898 128.8030780205 L 469.7396353990898 84.69802911050002 Z" paint-order="fill stroke markers"/></g><g><text x="487.463" y="112.468" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="#fff" stroke="#000" stroke-miterlimit="10" stroke-width="2.614" d="M 644.9072323074231 84.69802911050002 L 723.5328308658841 84.69802911050002 L 723.5328308658841 128.8030780205 L 644.9072323074231 128.8030780205 L 644.9072323074231 84.69802911050002 Z" paint-order="fill stroke markers"/></g><g><text x="662.631" y="112.468" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Server</text></g></g><g><path fill="#fff" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 506.17832057714844 290.5215906905 L 522.5135238771485 290.5215906905 L 522.5135238771485 640.0949413105 L 506.17832057714844 640.0949413105 L 506.17832057714844 290.5215906905" paint-order="fill stroke markers"/><g><g><rect width="117.341" height="21.236" x="540.612" y="161.473" fill="#fff" stroke="none"/></g><text x="543.063" y="176.175" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">I want to register!</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 514.3459222271484 182.70924891049998 L 670.7707142029869 182.70924891049998" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 670.6073621699869 175.90291420216664 L 684.2200315866536 182.70924891049998 L 670.6073621699869 189.51558361883332 Z" paint-order="stroke fill markers" transform="translate(684.2200315866536,182.70924891049998) translate(-684.2200315866536,-182.70924891049998)"/></g></g><g><g><rect width="67.664" height="21.236" x="565.451" y="207.212" fill="#fff" stroke="none"/></g><text x="567.901" y="221.914" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">challenge</text></g><g><path fill="none" stroke="#000" stroke-dasharray="6.534" stroke-miterlimit="10" stroke-width="1.361" d="M 684.2200315866536 228.44781815049998 L 516.3878226396484 228.44781815049998" paint-order="fill stroke markers"/><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 528.3411666102024 222.20442066487655 L 515.876222092698 228.44781815049998 L 528.3411666102024 234.69121563612342" paint-order="fill stroke markers" transform="translate(514.3459222271484,228.44781815049998) translate(-514.3459222271484,-228.44781815049998)"/></g></g><path fill="#fff" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 422.62914920382815 252.95062310049997 L 591.3610122804688 252.95062310049997 L 606.0626952504688 267.65230607049995 L 606.0626952504688 290.5215906905 L 422.62914920382815 290.5215906905 L 422.62914920382815 252.95062310049997 M 591.3610122804688 252.95062310049997 L 591.3610122804688 267.65230607049995 L 606.0626952504688 267.65230607049995" paint-order="fill stroke markers"/><g><text x="445.498" y="275.82" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">credentials.create(...)</text></g><g><g><rect width="104.306" height="21.236" x="343.31" y="315.024" fill="#fff" stroke="none"/></g><text x="345.761" y="329.726" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Create key pair</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 506.17832057714844 336.2601599305 L 298.1981215673906 336.2601599305" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 298.36147360039064 329.45382522216664 L 284.74880418372396 336.2601599305 L 298.36147360039064 343.0664946388333 Z" paint-order="stroke fill markers" transform="translate(284.74880418372396,336.2601599305) translate(-284.74880418372396,-336.2601599305)"/></g></g><g><g><rect width="222.445" height="21.236" x="42.974" y="360.763" fill="#fff" stroke="none"/></g><text x="45.424" y="375.465" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Request biometrics or device PIN</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 284.74880418372396 381.9987291705 L 37.09293221726042 381.9987291705" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 37.25628425026042 375.19239446216665 L 23.64361483359375 381.9987291705 L 37.25628425026042 388.8050638788333 Z" paint-order="stroke fill markers" transform="translate(23.64361483359375,381.9987291705) translate(-23.64361483359375,-381.9987291705)"/></g></g><g><g><rect width="39.947" height="21.236" x="134.223" y="406.502" fill="#fff" stroke="none"/></g><text x="136.673" y="421.203" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Done</text></g><g><path fill="none" stroke="#000" stroke-dasharray="6.534" stroke-miterlimit="10" stroke-width="1.361" d="M 23.64361483359375 427.7372984105 L 282.70690377122395 427.7372984105" paint-order="fill stroke markers"/><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 270.7535598006699 421.4939009248765 L 283.2185043181745 427.7372984105 L 270.7535598006699 433.98069589612345" paint-order="fill stroke markers" transform="translate(284.74880418372396,427.7372984105) translate(-284.74880418372396,-427.7372984105)"/></g></g><g><g><rect width="87.184" height="21.236" x="304.079" y="452.24" fill="#fff" stroke="none"/></g><text x="306.529" y="466.942" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">User verified</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 284.74880418372396 473.47586765049994 L 350.089617383724 473.47586765049994 L 350.089617383724 494.71163194049996 L 298.1981215673906 494.71163194049996" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 298.36147360039064 487.9052972321666 L 284.74880418372396 494.71163194049996 L 298.36147360039064 501.5179666488333 Z" paint-order="stroke fill markers" transform="translate(284.74880418372396,494.71163194049996) translate(-284.74880418372396,-494.71163194049996)"/></g></g><g><g><rect width="196.382" height="21.236" x="304.079" y="519.214" fill="#fff" stroke="none"/></g><text x="306.529" y="533.916" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Cryptographic key pair stored</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 284.74880418372396 540.4502011804999 L 350.089617383724 540.4502011804999 L 350.089617383724 561.6859654704999 L 298.1981215673906 561.6859654704999" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 298.36147360039064 554.8796307621666 L 284.74880418372396 561.6859654704999 L 298.36147360039064 568.4923001788333 Z" paint-order="stroke fill markers" transform="translate(284.74880418372396,561.6859654704999) translate(-284.74880418372396,-561.6859654704999)"/></g></g><g><g><rect width="78.773" height="21.236" x="345.329" y="586.189" fill="#fff" stroke="none"/></g><g><rect width="100.269" height="21.236" x="345.329" y="602.524" fill="#fff" stroke="none"/></g><g><rect width="72.545" height="21.236" x="345.329" y="618.859" fill="#fff" stroke="none"/></g><text x="347.779" y="600.89" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Public key,</text><text x="347.779" y="617.226" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">challenge and</text><text x="347.779" y="633.561" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">attestation</text></g><g><path fill="none" stroke="#000" stroke-dasharray="6.534" stroke-miterlimit="10" stroke-width="1.361" d="M 284.74880418372396 640.0949413105 L 504.1364201646484 640.0949413105" paint-order="fill stroke markers"/><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 492.1830761940944 633.8515438248766 L 504.648020711599 640.0949413105 L 492.1830761940944 646.3383387961234" paint-order="fill stroke markers" transform="translate(506.17832057714844,640.0949413105) translate(-506.17832057714844,-640.0949413105)"/></g></g><g><g><rect width="78.773" height="21.236" x="549.148" y="664.598" fill="#fff" stroke="none"/></g><g><rect width="100.269" height="21.236" x="549.148" y="680.933" fill="#fff" stroke="none"/></g><g><rect width="72.545" height="21.236" x="549.148" y="697.268" fill="#fff" stroke="none"/></g><text x="551.599" y="679.299" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Public key,</text><text x="551.599" y="695.635" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">challenge and</text><text x="551.599" y="711.97" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">attestation</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 514.3459222271484 718.5039171505 L 670.7707142029869 718.5039171505" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 670.6073621699869 711.6975824421667 L 684.2200315866536 718.5039171505 L 670.6073621699869 725.3102518588333 Z" paint-order="stroke fill markers" transform="translate(684.2200315866536,718.5039171505) translate(-684.2200315866536,-718.5039171505)"/></g></g><g><g><rect width="108.401" height="21.236" x="703.55" y="743.007" fill="#fff" stroke="none"/></g><text x="706" y="757.708" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Verify challenge</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 684.2200315866536 764.2424863905 L 749.5608447866535 764.2424863905 L 749.5608447866535 785.4782506805 L 697.6693489703202 785.4782506805" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 697.8327010033203 778.6719159721666 L 684.2200315866536 785.4782506805 L 697.8327010033203 792.2845853888333 Z" paint-order="stroke fill markers" transform="translate(684.2200315866536,785.4782506805) translate(-684.2200315866536,-785.4782506805)"/></g></g><g><g><rect width="118.172" height="21.236" x="703.55" y="809.981" fill="#fff" stroke="none"/></g><text x="706" y="824.683" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Check attestation</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 684.2200315866536 831.2168199204999 L 749.5608447866535 831.2168199204999 L 749.5608447866535 852.4525842104999 L 697.6693489703202 852.4525842104999" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 697.8327010033203 845.6462495021666 L 684.2200315866536 852.4525842104999 L 697.8327010033203 859.2589189188333 Z" paint-order="stroke fill markers" transform="translate(684.2200315866536,852.4525842104999) translate(-684.2200315866536,-852.4525842104999)"/></g></g><g><g><rect width="109.203" height="21.236" x="703.55" y="876.955" fill="#fff" stroke="none"/></g><text x="706" y="891.657" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Store public key</text></g><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 684.2200315866536 898.1911534504999 L 749.5608447866535 898.1911534504999 L 749.5608447866535 919.4269177404999 L 697.6693489703202 919.4269177404999" paint-order="fill stroke markers"/><g><path fill="#000" stroke="none" d="M 697.8327010033203 912.6205830321666 L 684.2200315866536 919.4269177404999 L 697.8327010033203 926.2332524488332 Z" paint-order="stroke fill markers" transform="translate(684.2200315866536,919.4269177404999) translate(-684.2200315866536,-919.4269177404999)"/></g></g><g><g><rect width="123.047" height="21.236" x="537.76" y="943.93" fill="#fff" stroke="none"/></g><text x="540.21" y="958.631" fill="#000" stroke="none" dominant-baseline="alphabetic" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-anchor="start" text-decoration="normal" xml:space="preserve">Device regsitered!</text></g><g><path fill="none" stroke="#000" stroke-dasharray="6.534" stroke-miterlimit="10" stroke-width="1.361" d="M 684.2200315866536 965.1654869804998 L 516.3878226396484 965.1654869804998" paint-order="fill stroke markers"/><g><path fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.361" d="M 528.3411666102024 958.9220894948764 L 515.876222092698 965.1654869804998 L 528.3411666102024 971.4088844661233" paint-order="fill stroke markers" transform="translate(514.3459222271484,965.1654869804998) translate(-514.3459222271484,-965.1654869804998)"/></g></g></g></g></svg>